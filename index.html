<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyst Work Tracker</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <nav class="sidebar">
        <div class="logo">
            <i class="fa-solid fa-cube"></i>
            <span>Analyst<span style="font-weight:300">OS</span></span>
        </div>
        
        <ul class="nav-links">
            <li class="active" data-tab="tasks-view">
                <i class="fa-solid fa-check-double"></i> Tasks
            </li>
            <li data-tab="journal-view">
                <i class="fa-solid fa-align-left"></i> Daily Recaps
            </li>
            <li data-tab="notes-view">
                <i class="fa-solid fa-sticky-note"></i> Notes
            </li>
            <li data-tab="milestones-view">
                <i class="fa-solid fa-flag-checkered"></i> Milestones
            </li>
            <li data-tab="history-view">
                <i class="fa-solid fa-clock-rotate-left"></i> History
            </li>
        </ul>

        <div class="bottom-actions">
            <button id="theme-toggle"><i class="fa-solid fa-circle-half-stroke"></i></button>
            <button id="export-btn"><i class="fa-solid fa-file-export"></i> Export</button>
            <button id="refresh-btn"><i class="fa-solid fa-rotate"></i> Sync</button>
        </div>
    </nav>

    <main class="main-content">
        
        <div id="backup-warning" class="warning-banner" style="display:none;">
            <i class="fa-solid fa-triangle-exclamation"></i> 
            It is the end of the month. Please Export your data.
            <button onclick="window.exportData()">Download Now</button>
            <button class="close-warn" onclick="document.getElementById('backup-warning').style.display='none'">&times;</button>
        </div>

        <section id="tasks-view" class="view active-view">
            <header class="top-bar">
                <div>
                    <h1>Tasks</h1>
                    <div style="display:flex; align-items:center; gap:10px; margin-top:5px;">
                        <p class="subtitle" id="current-date-display">Today</p>
                        <select id="board-project-filter" onchange="window.renderTasks()" class="header-filter">
                            <option value="All">All Projects</option>
                            </select>
                    </div>
                </div>
                <button class="btn-black" onclick="window.openTaskModal()">
                    <i class="fa-solid fa-plus"></i> New Task
                </button>
            </header>

            <div class="board-section">
                <h3>Today's Focus</h3>
                <div class="kanban-board compact-board">
                    <div class="kanban-column" data-status="To Do" id="daily-todo"></div>
                    <div class="kanban-column" data-status="In Progress" id="daily-progress"></div>
                    <div class="kanban-column" data-status="Done" id="daily-done"></div>
                </div>
            </div>

            <div class="board-section">
                <h3>This Week / Upcoming</h3>
                <div class="kanban-board">
                    <div class="kanban-column" data-status="To Do" id="weekly-todo"></div>
                    <div class="kanban-column" data-status="In Progress" id="weekly-progress"></div>
                    <div class="kanban-column" data-status="Done" id="weekly-done"></div>
                </div>
            </div>
        </section>

        <section id="journal-view" class="view">
            <header class="top-bar">
                <h1>Daily Recaps</h1>
                <button class="btn-black" onclick="window.openJournalModal()">
                    <i class="fa-solid fa-pen"></i> New Entry
                </button>
            </header>
            <div id="journal-feed" class="journal-container"></div>
        </section>

        <section id="notes-view" class="view">
            <header class="top-bar">
                <h1>Personal Notes</h1>
                <div style="display:flex; gap:10px;">
                    <input type="date" id="notes-date-filter" onchange="window.renderNotes()" style="padding:8px; width:auto;">
                    <button class="btn-black" onclick="window.openNoteModal()">
                        <i class="fa-solid fa-plus"></i> Add Note
                    </button>
                </div>
            </header>
            <h3 style="margin-bottom:15px; font-size:0.9rem; color:var(--text-muted);"><i class="fa-solid fa-thumbtack"></i> Pinned</h3>
            <div id="pinned-notes-container" class="notes-grid"></div>
            <hr style="margin: 30px 0; border:none; border-top:1px solid var(--border);">
            <h3 style="margin-bottom:15px; font-size:0.9rem; color:var(--text-muted);">Timeline</h3>
            <div id="all-notes-container" class="notes-list"></div>
        </section>

        <section id="milestones-view" class="view">
            <header class="top-bar">
                <h1>Milestones</h1>
                <div class="view-switcher">
                    <button class="view-btn active" onclick="window.switchMilestoneView('kanban')"><i class="fa-solid fa-columns"></i></button>
                    <button class="view-btn" onclick="window.switchMilestoneView('list')"><i class="fa-solid fa-list"></i></button>
                    <button class="view-btn" onclick="window.switchMilestoneView('calendar')"><i class="fa-solid fa-calendar"></i></button>
                    <button class="btn-black" style="margin-left: 15px;" onclick="window.openMilestoneModal()">
                        <i class="fa-solid fa-plus"></i>
                    </button>
                </div>
            </header>
            <div id="ms-kanban" class="ms-view-container active">
                <div class="kanban-board">
                    <div class="kanban-column" id="ms-col-todo"><h4>Planned</h4></div>
                    <div class="kanban-column" id="ms-col-progress"><h4>Learning</h4></div>
                    <div class="kanban-column" id="ms-col-done"><h4>Mastered</h4></div>
                </div>
            </div>
            <div id="ms-list" class="ms-view-container">
                <table class="simple-table">
                    <thead><tr><th>Milestone</th><th>Target Date</th><th>Progress</th><th>Action</th></tr></thead>
                    <tbody id="ms-table-body"></tbody>
                </table>
            </div>
            <div id="ms-calendar" class="ms-view-container">
                <div class="calendar-header"><h3 id="cal-month-name">Month</h3></div>
                <div class="calendar-grid" id="calendar-grid"></div>
            </div>
        </section>

        <section id="history-view" class="view">
            <header class="top-bar">
                <h1>Task History</h1>
                <select id="history-filter" onchange="window.renderHistory()">
                    <option value="all">All Time</option>
                    <option value="last-week">Last Week</option>
                    <option value="last-month">Last Month</option>
                </select>
            </header>
            <div class="history-dashboard">
                <div class="dash-card"><h3>Completed</h3><div class="dash-num" id="dash-total">0</div></div>
                <div class="dash-card"><h3>Top Project</h3><div class="dash-text" id="dash-cat">-</div></div>
            </div>
            <div class="history-container">
                <table class="simple-table">
                    <thead><tr><th>Task</th><th>Project</th><th>Category</th><th>Date</th><th>Action</th></tr></thead>
                    <tbody id="history-table-body"></tbody>
                </table>
            </div>
        </section>

    </main>

    <div id="task-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="window.closeModal('task-modal')">&times;</span>
            <h2 id="task-modal-title">Task</h2>
            <form id="task-form">
                <input type="hidden" id="task-id">
                <div class="form-group"><label>Title</label><input type="text" id="t-title" required placeholder="Task name"></div>
                
                <div class="form-group two-col">
                    <div><label>Due Date</label><input type="date" id="t-date" required></div>
                    <div><label>Priority</label><select id="t-priority"><option value="Low">Low</option><option value="Medium" selected>Medium</option><option value="High">High</option></select></div>
                </div>

                <div class="form-group">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;">
                        <label>Project (The Big Picture)</label>
                        <button type="button" class="btn-text-small" onclick="window.toggleProjManager()">Manage Projects</button>
                    </div>
                    <div id="proj-manager" style="display:none; margin-bottom:10px; background:var(--bg-body); padding:10px; border-radius:4px;">
                        <div style="display:flex; gap:5px; margin-bottom:10px;">
                            <input type="text" id="new-proj-input" placeholder="New Project Name">
                            <button type="button" class="btn-black-small" onclick="window.addProject()">Add</button>
                        </div>
                        <div id="proj-list-display" class="cat-tags-list"></div>
                    </div>
                    <select id="t-project"><option value="">General Work</option></select>
                </div>

                <div class="form-group">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;">
                        <label>Category (Type of Task)</label>
                        <button type="button" class="btn-text-small" onclick="window.toggleCatManager()">Manage Categories</button>
                    </div>
                    <div id="cat-manager" style="display:none; margin-bottom:10px; background:var(--bg-body); padding:10px; border-radius:4px;">
                        <div style="display:flex; gap:5px; margin-bottom:10px;">
                            <input type="text" id="new-cat-input" placeholder="New Category">
                            <button type="button" class="btn-black-small" onclick="window.addCategory()">Add</button>
                        </div>
                        <div id="cat-list-display" class="cat-tags-list"></div>
                    </div>
                    <select id="t-category"><option value="">No Category</option></select>
                </div>

                <div class="form-group"><label>Details & Comments</label><textarea id="t-notes" rows="4"></textarea></div>
                <div class="form-group"><label>Status</label><select id="t-status"><option value="To Do">To Do</option><option value="In Progress">In Progress</option><option value="Done">Done</option></select></div>
                <div class="modal-actions"><button type="button" class="btn-text delete-btn-hidden" id="btn-delete-task" onclick="window.deleteCurrentTask()">Delete</button><button type="submit" class="btn-black">Save Task</button></div>
            </form>
        </div>
    </div>

    <div id="journal-modal" class="modal">
        <div class="modal-content large-modal">
            <span class="close-modal" onclick="window.closeModal('journal-modal')">&times;</span>
            <h2 id="journal-modal-title">Daily Update</h2>
            <form id="journal-form">
                <input type="hidden" id="j-id">
                <div class="form-group two-col"><div><label>Date</label><input type="date" id="j-date" required></div><div><label>Time</label><input type="text" id="j-time" placeholder="10:00 - 18:00" required></div></div>
                <div class="form-group"><label>Today's Recap</label><textarea id="j-recap" rows="5" required></textarea></div>
                <div class="form-group"><label>Tomorrow's Plan</label><textarea id="j-plan" rows="4" required></textarea></div>
                <div class="form-group"><label>Notes</label><textarea id="j-notes" rows="2"></textarea></div>
                <button type="submit" class="btn-black full-width">Save Entry</button>
            </form>
        </div>
    </div>

    <div id="note-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="window.closeModal('note-modal')">&times;</span>
            <h2>Quick Note</h2>
            <form id="note-form">
                <input type="hidden" id="n-id">
                <div class="form-group two-col">
                    <div><label>Date</label><input type="date" id="n-date" required></div>
                    <div style="display:flex; align-items:flex-end;"><label style="cursor:pointer; display:flex; align-items:center; gap:8px;"><input type="checkbox" id="n-pinned" style="width:auto;"> Pin to Dashboard</label></div>
                </div>
                <div class="form-group"><label>Content</label><textarea id="n-content" rows="8" required></textarea></div>
                <div class="modal-actions"><button type="button" class="btn-text delete-btn-hidden" id="btn-delete-note" onclick="window.deleteCurrentNote()">Delete</button><button type="submit" class="btn-black">Save Note</button></div>
            </form>
        </div>
    </div>

    <div id="milestone-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="window.closeModal('milestone-modal')">&times;</span>
            <h2 id="ms-modal-title">Milestone</h2>
            <form id="milestone-form">
                <input type="hidden" id="m-id">
                <div class="form-group"><label>Title</label><input type="text" id="m-title" required></div>
                <div class="form-group two-col"><div><label>Date</label><input type="date" id="m-date" required></div><div><label>Status</label><select id="m-status"><option value="Planned">Planned</option><option value="In Progress">In Progress</option><option value="Mastered">Mastered</option></select></div></div>
                <div class="form-group"><label>Details</label><textarea id="m-details" rows="4"></textarea></div>
                <div class="form-group"><label>Progress</label><input type="range" id="m-progress" min="0" max="100" value="0" oninput="document.getElementById('m-prog-val').innerText = this.value + '%'"><span id="m-prog-val">0%</span></div>
                <div class="modal-actions"><button type="button" class="btn-text delete-btn-hidden" id="btn-delete-ms" onclick="window.deleteCurrentMS()">Delete</button><button type="submit" class="btn-black">Save</button></div>
            </form>
        </div>
    </div>

    <script type="module" src="script.js"></script>
</body>
</html>
